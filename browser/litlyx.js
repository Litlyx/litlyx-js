!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var s in i)("object"==typeof exports?exports:e)[s]=i[s]}}(self,(()=>{return e={941:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lit=void 0;const s=i(241),o=i(42);if(t.Lit=new class{project_id;initialized=!1;settings;hooked=!1;init(e,t){if(this.initialized)return console.warn("Already initialized");if(t?.testMode&&console.log("INIT"),this.initialized=!0,this.project_id=e,this.settings={testMode:!1,manualMode:!1,server:{host:"broker.litlyx.com",port:443,secure:!0},...t},!(0,o.isClient)())return;this.settings.manualMode||(this.pushVisit(),this.hookHistory()),(0,s.sendRequest)(e,"/keep_alive",{website:location.hostname,userAgent:navigator.userAgent||"",instant:!0},this.settings.server);let i=0;setInterval((()=>{document.hidden||(i+=10),i>=60&&(i-=60,(0,s.sendRequest)(e,"/keep_alive",{website:location.hostname,userAgent:navigator.userAgent||""},this.settings.server))}),1e4)}hookHistory(){if(this.hooked)return;this.hooked=!0;const e=this,t=history.pushState;history.pushState=function(i,s,o){t.apply(this,[i,s,o]),e.pushVisit()},addEventListener("popstate",(()=>e.pushVisit()))}async event(e,t){if(!this.initialized)return console.error("Not initialized");if(!this.project_id)return console.error("project_id is required");if(!this.settings)return console.error("You must call init before pushing");const i=t?.metadata?JSON.stringify(t.metadata):void 0;await(0,s.sendRequest)(this.project_id,"/event",{name:e,metadata:i,website:location.host||"SERVER_SIDE",userAgent:navigator.userAgent||"SERVER_SIDE"},this.settings.server)}async pushVisit(e){if((0,o.isClient)())return this.initialized?this.project_id?this.settings?this.initialized?this.project_id?void await(0,s.sendRequest)(this.project_id,"/visit",{website:location.host,page:e??location.pathname,referrer:document.referrer||"self",userAgent:navigator.userAgent||""},this.settings.server):console.error("project_id is required"):console.error("Not initialized"):console.error("You must call init before pushing"):console.error("project_id is required"):console.error("Not initialized")}},(0,o.isClient)()){const e=document.querySelector("script[data-project]");if(e){const i=e.getAttribute("data-project"),s=e.getAttribute("data-host"),o=e.getAttribute("data-port"),r=e.getAttribute("data-secure"),n=e.getAttribute("data-manual");i&&(console.log("Litlyx init on project",i),t.Lit.init(i,{manualMode:!!n&&"true"===n,server:{host:s||"broker.litlyx.com",port:o?parseInt(o):443,secure:!r||"true"===r}}))}}},241:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendRequest=void 0;const s=i(42);t.sendRequest=function(e,t,o,r){!function(e,t,o,r,n){try{const a=r?"https":"http";if((0,s.isClient)()){const i=`${a}://${e}:${o}${t}`;fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).catch((e=>{console.error("ERROR PUSHING",e)}))}else{const s=i(r?453:34).request({hostname:e,path:t,port:o,method:"POST",headers:{"Content-Type":"application/json"}});s.on("error",(e=>console.error("ERROR PUSHING",e)));const a=JSON.stringify(n);s.write(a),s.end()}}catch(e){console.error("ERROR PUSHING",e)}}(r.host,t,r.port,r.secure,{...o,pid:e})}},42:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isClient=void 0,t.isClient=function(){return"object"==typeof window}},34:()=>{},453:()=>{}},t={},function i(s){var o=t[s];if(void 0!==o)return o.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,i),r.exports}(941);var e,t}));